deploy:
  # deploy develop to the staging environment
  - provider: script
    on:
      branch: dev

    sudo: required

    language: node_js
    node_js:
      - "6.9.1"

    before_script:
      - npm install -g @angular/cli
      - sudo apt-get install -y s3cmd

    script:
      - ng build --dev --aot
      - s3cmd sync --access_key=${S3_ACCESS_KEY} --secret_key=${S3_SECRET_KEY} --cf-invalidate --cf-invalidate-default-index dist/* s3://devhost.tkit.me

    notifications:
      slack: tkitme:YP4HX1luJf4x8QmXwqlVmnPv



  # deploy master to production
  - provider: script
    on:
      branch: master

    sudo: required

    language: node_js
    node_js:
      - "6.9.1"
    
    before_script:
      - npm install -g @angular/cli
      - sudo apt-get install -y s3cmd

    script:
      - ng build --prod --aot
      - s3cmd sync --access_key=${S3_ACCESS_KEY} --secret_key=${S3_SECRET_KEY} --cf-invalidate --cf-invalidate-default-index dist/* s3://host.tkit.me

    notifications:
      slack: tkitme:YP4HX1luJf4x8QmXwqlVmnPv
